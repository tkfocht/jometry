<html>
    <head>
        <title>J!ometry: Daily Jeopardy Visualizations</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto">
        <link rel="stylesheet" href="css/site.css"></link>
        <link rel="stylesheet" href="css/season.css"></link>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
        <script src="/js/d3/d3.v7.min.js"></script>
        <script src="/js/util/util.v3.js"></script>
        <script src="/js/graphs/full_game_scatter.v3.js"></script>
        <script src="/js/graphs/by_round_scatter.v1.js"></script>
        <script src="/js/graphs/scatterhist.v1.js"></script>
        <script src="/js/util/shared_graph_production.v4.js"></script>
    </head>
    <body>
        <h1><a href="index.html">J!ometry</a></h1>
        <div>
            <a href="/index.html">Home</a>&nbsp;<a href="/glossary.html">Glossary</a>
        </div>
        <div class="section">
            <h1><span id="contestant-name"></span> <span id="toc-period-id"></span> Summary</h1>
            <div id="season-contestant-summary" class="season-contestant-summary">
                <table>
                    <thead>
                        <tr>
                            <th colspan="1" class="empty"></th>
                            <th colspan="7">Jeopardy! Round</th>
                            <th colspan="7">Double Jeopardy! Round</th>
                        </tr>
                        <tr>
                            <th>Game</th>
                            <th>Att</th>
                            <th>BuzC</th>
                            <th>Speed</th>
                            <th>Solo</th>
                            <th>Buz$</th>
                            <th>DDF</th>
                            <th>Buz%</th>
                            <th>Att</th>
                            <th>BuzC</th>
                            <th>Speed</th>
                            <th>Solo</th>
                            <th>Buz$</th>
                            <th>DDF</th>
                            <th>Buz%</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="graph-description">
                Att = Attempts, BuzC = Correct on buzz,
                Speed = Est. buzzes created through speed, Solo = Estimated buzzes uncontested,
                Buz$ = Score on buzz, DDF = Daily Doubles found
            </div>
        </div>
        <div class="section">
            <h1>Attempt Distribution</h1>
            <div class="graph-description">
                Buzz attempts, by game. Correct responses are at the bottom, incorrect responses are lighter and
                in the middle, and attempts where the contestant was locked out are lightest and at the top (if known).
            </div>
            <div id="bar-attempts" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div class="graph-description">
                Average score on buzzes, by game. Score is shown full color. Score lost on incorrect buzz responses is shown lighter on top.
                Score on correct buzz responses is the sum of the two.
            </div>
            <div id="bar-buz$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Player Statistics</h1>
            <div class="graph-description">
                A collection of player statistics for this game, with the distribution of player performance for the play period shown in gray.
            </div>
            <div id="scatterhist-att-buz%" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="scatterhist-buz-buz$-per-buz" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="scatterhist-speed-solo" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="hist-att" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="hist-buz" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="hist-buzc" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="hist-buz$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div id="footer">
            <p>This site is not affiliated with Jeopardy!. Data is taken from their published <a href="https://www.jeopardy.com/jbuzz/news-events/jeopardy-daily-box-scores">box scores.</a></p>
        </div>
        <script type="text/javascript">
            var tocPeriodId = new URLSearchParams(window.location.search).get('toc_period_id');
            var tocPeriodAverageLabel = "All " + tocPeriodId + " Average";
            var contestantId = new URLSearchParams(window.location.search).get('contestant');
            d3.select("#toc-period-id")
                .data([tocPeriodId])
                .text(d => d);
            d3.csv(csvUrlForTocPeriod(tocPeriodId)).then(function(data) {
                d3.select("#contestant-name")
                    .data([getContestantNameFromData(data, contestantId)])
                    .text(d => d);
                
                //Data transformations
                data.forEach(function(d) {
                    d['Date'] = csvDateParse(d['Date']);
                    d['JBuz%'] = 100.0 * d['JBuz'] / d['JAtt'];
                    d['DJBuz%'] = 100.0 * d['DJBuz'] / d['DJAtt'];
                    d['Buz%'] = 100.0 * d['Buz'] / d['Att'];
                });
                data.forEach(function(d) {
                    d['highlightContestant'] = contestantId === d['Jometry Contestant Id'];
                });

                //Graphics functions
                var highlightColor = '#0072B2';
                var secondaryHighlightColor = '#009E73';
                var colorFunction = function(d) {
                    if (d['highlightContestant']) {
                        return highlightColor;
                    } else {
                        return "black";
                    }
                };
                var opacityFunction = function(d) {
                    if (d['highlightContestant']) {
                        return 1;
                    } else {
                        return 0.1;
                    }
                };
                var labelFunction = function(d) {
                    return d['Season'] + '-' + d['Game In Season'];
                };

                var boxScoreIncludedData = d3.filter(data, d => d['Att'] !== '');
                //Summary table
                var summaryData = Array.from(
                    d3.group(d3.filter(data, d => d['highlightContestant']), d => d['Jometry Game Id']),
                    ([game_id, gameData]) => ({
                        'Jometry Game Id': game_id,
                        'Game Label': gameData[0]['Season'] + '-' + gameData[0]['Game In Season'],
                        'Date': gameData[0]['Date'],
                        'JAtt': gameData[0]['Att'] === '' ? '' : +gameData[0]['JAtt'],
                        'JBuz': +gameData[0]['JBuz'],
                        'JBuzC': +gameData[0]['JBuzC'],
                        'JBuzInc': +gameData[0]['JBuzInc'],
                        'JSpeed': gameData[0]['Att'] === '' ? '' : +gameData[0]['JSpeed'],
                        'JSolo': gameData[0]['Att'] === '' ? '' : +gameData[0]['JSolo'],
                        'JBuz$': +gameData[0]['JBuz$'],
                        'JBuzI$': +gameData[0]['JBuzI$'],
                        'JDDF': +gameData[0]['JDDF'],
                        'JBuz%': gameData[0]['Att'] === '' ? '' : +gameData[0]['JBuz%'],
                        'DJAtt': gameData[0]['Att'] === '' ? '' : +gameData[0]['DJAtt'],
                        'DJBuz': +gameData[0]['DJBuz'],
                        'DJBuzC': +gameData[0]['DJBuzC'],
                        'DJBuzInc': +gameData[0]['DJBuzInc'],
                        'DJSpeed': gameData[0]['Att'] === '' ? '' : +gameData[0]['DJSpeed'],
                        'DJSolo': gameData[0]['Att'] === '' ? '' : +gameData[0]['DJSolo'],
                        'DJBuz$': +gameData[0]['DJBuz$'],
                        'DJBuzI$': +gameData[0]['DJBuzI$'],
                        'DJDDF': +gameData[0]['DJDDF'],
                        'DJBuz%': gameData[0]['Att'] === '' ? '' : +gameData[0]['DJBuz%'],
                        'Data': gameData
                    }));

                var contestantAverageLabel = "Average";
                var summaryDataWithBox = d3.filter(summaryData, d => d['JAtt'] !== '');
                var contestantAverageSummary = {
                    'Jometry Game Id': -1,
                    'Game Label': contestantAverageLabel,
                    'JAtt': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['JAtt'])).reduce((a, b) => a + b) / summaryDataWithBox.length).toFixed(1),
                    'JBuz': (d3.map(summaryData, cd => (+cd['JBuz'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'JBuzC': (d3.map(summaryData, cd => (+cd['JBuzC'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'JBuzInc': (d3.map(summaryData, cd => (+cd['JBuzInc'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'JSpeed': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['JSpeed'])).reduce((a, b) => a + b) / summaryDataWithBox.length).toFixed(1),
                    'JSolo': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['JSolo'])).reduce((a, b) => a + b) / summaryDataWithBox.length),
                    'JBuz$': (d3.map(summaryData, cd => (+cd['JBuz$'])).reduce((a, b) => a + b) / summaryData.length).toFixed(0),
                    'JBuzI$': (d3.map(summaryData, cd => (+cd['JBuzI$'])).reduce((a, b) => a + b) / summaryData.length).toFixed(0),
                    'JDDF': (d3.map(summaryData, cd => (+cd['JDDF'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'JBuz%': summaryDataWithBox.length <= 0 ? '' : 100.0 * d3.map(summaryDataWithBox, cd => (+cd['JBuz'])).reduce((a, b) => a + b) / d3.map(summaryDataWithBox, cd => (+cd['JAtt'])).reduce((a, b) => a + b),
                    'DJAtt': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['DJAtt'])).reduce((a, b) => a + b) / summaryDataWithBox.length).toFixed(1),
                    'DJBuz': (d3.map(summaryData, cd => (+cd['DJBuz'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'DJBuzC': (d3.map(summaryData, cd => (+cd['DJBuzC'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'DJBuzInc': (d3.map(summaryData, cd => (+cd['DJBuzInc'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'DJSpeed': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['DJSpeed'])).reduce((a, b) => a + b) / summaryDataWithBox.length).toFixed(1),
                    'DJSolo': summaryDataWithBox.length <= 0 ? '' : (d3.map(summaryDataWithBox, cd => (+cd['DJSolo'])).reduce((a, b) => a + b) / summaryDataWithBox.length),
                    'DJBuz$': (d3.map(summaryData, cd => (+cd['DJBuz$'])).reduce((a, b) => a + b) / summaryData.length).toFixed(0),
                    'DJBuzI$': (d3.map(summaryData, cd => (+cd['DJBuzI$'])).reduce((a, b) => a + b) / summaryData.length).toFixed(0),
                    'DJDDF': (d3.map(summaryData, cd => (+cd['DJDDF'])).reduce((a, b) => a + b) / summaryData.length).toFixed(1),
                    'DJBuz%': summaryDataWithBox.length <= 0 ? '' : 100.0 * d3.map(summaryDataWithBox, cd => (+cd['DJBuz'])).reduce((a, b) => a + b) / d3.map(summaryDataWithBox, cd => (+cd['DJAtt'])).reduce((a, b) => a + b)
                };
                var tocPeriodAverageSummary = {
                    'Jometry Game Id': -1,
                    'Game Label': tocPeriodAverageLabel,
                    'JAtt': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['JAtt'])).reduce((a, b) => a + b) / boxScoreIncludedData.length).toFixed(1),
                    'JBuz': (d3.map(data, cd => (+cd['JBuz'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'JBuzC': (d3.map(data, cd => (+cd['JBuzC'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'JBuzInc': (d3.map(data, cd => (+cd['JBuzInc'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'JSpeed': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['JSpeed'])).reduce((a, b) => a + b) / boxScoreIncludedData.length).toFixed(1),
                    'JSolo': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['JSolo'])).reduce((a, b) => a + b) / boxScoreIncludedData.length),
                    'JBuz$': (d3.map(data, cd => (+cd['JBuz$'])).reduce((a, b) => a + b) / data.length).toFixed(0),
                    'JBuzI$': (d3.map(data, cd => (+cd['JBuzI$'])).reduce((a, b) => a + b) / data.length).toFixed(0),
                    'JDDF': (d3.map(data, cd => (+cd['JDDF'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'JBuz%': summaryDataWithBox.length <= 0 ? '' : 100.0 * d3.map(boxScoreIncludedData, cd => (+cd['JBuz'])).reduce((a, b) => a + b) / d3.map(boxScoreIncludedData, cd => (+cd['JAtt'])).reduce((a, b) => a + b),
                    'DJAtt': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['DJAtt'])).reduce((a, b) => a + b) / boxScoreIncludedData.length).toFixed(1),
                    'DJBuz': (d3.map(data, cd => (+cd['DJBuz'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'DJBuzC': (d3.map(data, cd => (+cd['DJBuzC'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'DJBuzInc': (d3.map(data, cd => (+cd['DJBuzInc'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'DJSpeed': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['DJSpeed'])).reduce((a, b) => a + b) / boxScoreIncludedData.length).toFixed(1),
                    'DJSolo': summaryDataWithBox.length <= 0 ? '' : (d3.map(boxScoreIncludedData, cd => (+cd['DJSolo'])).reduce((a, b) => a + b) / boxScoreIncludedData.length),
                    'DJBuz$': (d3.map(data, cd => (+cd['DJBuz$'])).reduce((a, b) => a + b) / data.length).toFixed(0),
                    'DJBuzI$': (d3.map(data, cd => (+cd['DJBuzI$'])).reduce((a, b) => a + b) / data.length).toFixed(0),
                    'DJDDF': (d3.map(data, cd => (+cd['DJDDF'])).reduce((a, b) => a + b) / data.length).toFixed(1),
                    'DJBuz%': summaryDataWithBox.length <= 0 ? '' : 100.0 * d3.map(boxScoreIncludedData, cd => (+cd['DJBuz'])).reduce((a, b) => a + b) / d3.map(boxScoreIncludedData, cd => (+cd['DJAtt'])).reduce((a, b) => a + b)
                };

                var summaryDataWithAverage = summaryData.concat([contestantAverageSummary, tocPeriodAverageSummary]);

                var summaryTr = d3.select("#season-contestant-summary table tbody")
                    .selectAll("tr")
                    .data(summaryDataWithAverage)
                    .enter()
                    .append("tr");
                summaryTr.selectAll("td")
                    .data(function(d,i) {
                        return [
                            (d['Game Label'] === contestantAverageLabel || d['Game Label'] === tocPeriodAverageLabel) ? d['Game Label'] : '<a href="game.html?toc_period_id=' + tocPeriodId + '&game_id=' + d['Jometry Game Id'] + '">' + d['Game Label'] + '</a>&nbsp;' + dateFormat(d['Date']),
                            d['JAtt'] === '' ? '' : +d['JAtt'],
                            d['JBuzC'],
                            d['JAtt'] === '' ? '' : (+d['JSpeed'] > 0 ? "+" : "") + (+d['JSpeed']).toFixed(1),
                            d['JAtt'] === '' ? '' : (+d['JSolo']).toFixed(1),
                            d['JBuz$'],
                            d['JDDF'],
                            d['JAtt'] === '' ? '' : d['JBuz%'].toFixed(1),
                            d['DJAtt'] === '' ? '' : d['DJAtt'],
                            d['DJBuzC'],
                            d['DJAtt'] === '' ? '' : (+d['DJSpeed'] > 0 ? "+" : "") + (+d['DJSpeed']).toFixed(1),
                            d['DJAtt'] === '' ? '' : (+d['DJSolo']).toFixed(1),
                            d['DJBuz$'],
                            d['DJDDF'],
                            d['DJAtt'] === '' ? '' : d['DJBuz%'].toFixed(1)
                        ];
                    })
                    .enter()
                    .append("td")
                    .html(d => d);

                //Attempt Distribution
                var summaryColorFunction = function(d) {
                    if (d['Game In Season'] === contestantAverageLabel) {
                        return secondaryHighlightColor;
                    } else if (d['Game In Season'] === seasonAverageLabel) {
                        return "black";
                    } else {
                        return highlightColor;
                    }
                }

                var contestantData = d3.filter(data, cd => cd['highlightContestant']);

                //Attempts
                var attemptsTraceBuzC = {
                    x: d3.map(contestantData, d => d['Season'] + '-' + d['Game In Season']).concat(['Contestant Avg','Period Avg']),
                    y: d3.map(contestantData, cd1 => +cd1['JBuzC'] + +cd1['DJBuzC']).concat([
                        +contestantAverageSummary['JBuzC'] + +contestantAverageSummary['DJBuzC'],
                        +tocPeriodAverageSummary['JBuzC'] + +tocPeriodAverageSummary['DJBuzC']]),
                    text: d3.map(contestantData, cd1 => +cd1['JBuzC'] + +cd1['DJBuzC']).concat([
                        (+contestantAverageSummary['JBuzC'] + +contestantAverageSummary['DJBuzC']).toFixed(1),
                        (+tocPeriodAverageSummary['JBuzC'] + +tocPeriodAverageSummary['DJBuzC']).toFixed(1)]),
                    type: 'bar',
                    marker: {
                        color: d3.map(contestantData, d => highlightColor).concat([secondaryHighlightColor, 'black']),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 1
                    }
                };
                var attemptsTraceBuzI = {
                    x: d3.map(contestantData, d => d['Season'] + '-' + d['Game In Season']).concat(['Contestant Avg','Period Avg']),
                    y: d3.map(contestantData, cd1 => +cd1['JBuzInc'] + +cd1['DJBuzInc']).concat([
                        +contestantAverageSummary['JBuzInc'] + +contestantAverageSummary['DJBuzInc'],
                        +tocPeriodAverageSummary['JBuzInc'] + +tocPeriodAverageSummary['DJBuzInc']]),
                    text: d3.map(contestantData, cd1 => +cd1['JBuzInc'] + +cd1['DJBuzInc']).concat([
                        (+contestantAverageSummary['JBuzInc'] + +contestantAverageSummary['DJBuzInc']).toFixed(1),
                        (+tocPeriodAverageSummary['JBuzInc'] + +tocPeriodAverageSummary['DJBuzInc']).toFixed(1)]),
                    type: 'bar',
                    marker: {
                        color: d3.map(contestantData, d => highlightColor).concat([secondaryHighlightColor, 'black']),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 0.6
                    }
                };
                var attemptsTraceBlockedAttempts = {
                    x: d3.map(contestantData, d => d['Season'] + '-' + d['Game In Season']).concat(['Contestant Avg','Period Avg']),
                    y: d3.map(contestantData, cd1 => cd1['JAtt'] === '' ? 0 : +cd1['JAtt'] + +cd1['DJAtt'] - +cd1['JBuzC'] - +cd1['DJBuzC'] - +cd1['JBuzInc'] - +cd1['DJBuzInc']).concat([
                        contestantAverageSummary['JAtt'] === '' ? 0 : +contestantAverageSummary['JAtt'] + +contestantAverageSummary['DJAtt'] - +contestantAverageSummary['JBuzC'] - +contestantAverageSummary['DJBuzC'] - +contestantAverageSummary['JBuzInc'] - +contestantAverageSummary['DJBuzInc'],
                        tocPeriodAverageSummary['JAtt'] === '' ? 0 : +tocPeriodAverageSummary['JAtt'] + +tocPeriodAverageSummary['DJAtt'] - +tocPeriodAverageSummary['JBuzC'] - +tocPeriodAverageSummary['DJBuzC'] - +tocPeriodAverageSummary['JBuzInc'] - +tocPeriodAverageSummary['DJBuzInc']]),
                    text: d3.map(contestantData, cd1 => +cd1['DJAtt'] - +cd1['JBuzInc'] - +cd1['DJBuzInc']).concat([
                        (contestantAverageSummary['JAtt'] === '' ? 0 : +contestantAverageSummary['JAtt'] + +contestantAverageSummary['DJAtt'] - +contestantAverageSummary['JBuzC'] - +contestantAverageSummary['DJBuzC'] - +contestantAverageSummary['JBuzInc'] - +contestantAverageSummary['DJBuzInc']).toFixed(1),
                        (tocPeriodAverageSummary['JAtt'] === '' ? 0 : +tocPeriodAverageSummary['JAtt'] + +tocPeriodAverageSummary['DJAtt'] - +tocPeriodAverageSummary['JBuzC'] - +tocPeriodAverageSummary['DJBuzC'] - +tocPeriodAverageSummary['JBuzInc'] - +tocPeriodAverageSummary['DJBuzInc']).toFixed(1)]),
                    type: 'bar',
                    marker: {
                        color: d3.map(contestantData, d => highlightColor).concat([secondaryHighlightColor, 'black']),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 0.2
                    }
                };
                var attemptsData = [attemptsTraceBuzC, attemptsTraceBuzI, attemptsTraceBlockedAttempts];
                var attemptsLayout = {
                    barmode: 'stack',
                    showlegend: false,
                    yaxis: {
                        title: {
                            text: "Attempts",
                            standoff: 20
                        }
                    }
                };
                Plotly.newPlot('bar-attempts', attemptsData, attemptsLayout);

                var buzScoreTrace = {
                    x: d3.map(contestantData, d => d['Season'] + '-' + d['Game In Season']).concat(['Contestant Avg','Period Avg']),
                    y: d3.map(contestantData, cd1 => +cd1['Buz$']).concat([
                        +contestantAverageSummary['JBuz$'] + +contestantAverageSummary['DJBuz$'],
                        +tocPeriodAverageSummary['JBuz$'] + +tocPeriodAverageSummary['DJBuz$']]),
                    text: d3.map(contestantData, cd1 => +cd1['Buz$']).concat([
                        (+contestantAverageSummary['JBuz$'] + +contestantAverageSummary['DJBuz$']).toFixed(0),
                        (+tocPeriodAverageSummary['JBuz$'] + +tocPeriodAverageSummary['DJBuz$']).toFixed(0)]),
                    type: 'bar',
                    marker: {
                        color: d3.map(contestantData, d => highlightColor).concat([secondaryHighlightColor, 'black']),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 1
                    }
                };
                var buzIScoreTrace = {
                    x: d3.map(contestantData, d => d['Season'] + '-' + d['Game In Season']).concat(['Contestant Avg','Period Avg']),
                    y: d3.map(contestantData, d => +d['JBuzI$'] + +d['DJBuzI$']).concat([
                        +contestantAverageSummary['JBuzI$'] + +contestantAverageSummary['DJBuzI$'],
                        +tocPeriodAverageSummary['JBuzI$'] + +tocPeriodAverageSummary['DJBuzI$']]),
                    text: d3.map(contestantData, d => +d['JBuzI$'] + +d['DJBuzI$']).concat([
                        (+contestantAverageSummary['JBuzI$'] + +contestantAverageSummary['DJBuzI$']).toFixed(0),
                        (+tocPeriodAverageSummary['JBuzI$'] + +tocPeriodAverageSummary['DJBuzI$']).toFixed(0)]),
                    type: 'bar',
                    marker: {
                        color: d3.map(contestantData, d => highlightColor).concat([secondaryHighlightColor, 'black']),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 0.3
                    }
                };
                var buzScoreData = [buzScoreTrace, buzIScoreTrace];
                var buzScoreLayout = {
                    barmode: 'stack',
                    showlegend: false,
                    yaxis: {
                        title: {
                            text: "Buz$",
                            standoff: 20
                        }
                    }
                };
                Plotly.newPlot('bar-buz$', buzScoreData, buzScoreLayout);

                var hasBoxScoreData = d3.filter(data, d => d['highlightContestant'] && d['Att'] !== '').length > 0;

                if (hasBoxScoreData) {
                    //Speed/Solo
                    renderHighlightScatterHistogram(
                        data,
                        'scatterhist-speed-solo',
                        'Speed and Solo',
                        d => d['Speed'] !== '' && d['Solo'] !== '',
                        d => d['highlightContestant'],
                        'Speed',
                        d => d['Speed'],
                        { start: -20.5, end: 20.5, size: 1 },
                        'Solo',
                        d => d['Solo'],
                        { start: 0, end: 25, size: 1 },
                        colorFunction,
                        labelFunction
                    );

                    //Att/Buz%
                    renderHighlightScatterHistogram(
                        data,
                        'scatterhist-att-buz%',
                        'Att and Buz%',
                        d => d['Att'] !== '' && d['Buz%'] !== '',
                        d => d['highlightContestant'],
                        'Att',
                        d => d['Att'],
                        { start: -0.5, end: 57.5, size: 1 },
                        'Buz%',
                        d => d['Buz%'],
                        { start: 0, end: 100, size: 5 },
                        colorFunction,
                        labelFunction
                    );                    

                    renderHighlightHistogram(
                        data,
                        'hist-att',
                        'Attempts',
                        d => d['Att'] !== '',
                        d => d['highlightContestant'],
                        'Att',
                        d => +d['Att'],
                        { start: -0.5, end: 57.5, size: 1 },
                        colorFunction,
                        labelFunction
                    );                    
                } else {
                    ids = ['scatterhist-att-buz%', 'scatterhist-speed-solo', 'hist-att'];
                    ids.forEach(id => {
                        document.getElementById(id).style.display = 'none';
                    });
                }

                //Buz vs Buz$/Buz
                renderHighlightScatterHistogram(
                    data,
                    'scatterhist-buz-buz$-per-buz',
                    'Buz vs Buz$/Buz',
                    d => true,
                    d => d['highlightContestant'],
                    'Buz',
                    d => d['Buz'],
                    { start: -0.5, end: 45.5, size: 1 },
                    'Buz$/Buz',
                    d => d['Buz$/Buz'],
                    { start: -650, end: 1150, size: 100 },
                    colorFunction,
                    labelFunction
                );

                renderHighlightHistogram(
                    data,
                    'hist-buz',
                    'Buzzes',
                    d => true,
                    d => d['highlightContestant'],
                    'Buz',
                    d => +d['Buz'],
                    { start: -0.5, end: 57.5, size: 1 },
                    colorFunction,
                    labelFunction
                );

                renderHighlightHistogram(
                    data,
                    'hist-buzc',
                    'Correct Buzzes',
                    d => true,
                    d => d['highlightContestant'],
                    'BuzC',
                    d => +d['JBuzC'] + +d['DJBuzC'],
                    { start: -0.5, end: 57.5, size: 1 },
                    colorFunction,
                    labelFunction
                );

                renderHighlightHistogram(
                    data,
                    'hist-buz$',
                    'Buz$',
                    d => true,
                    d => d['highlightContestant'],
                    'Buz$',
                    d => +d['Buz$'],
                    { start: -20000, end: 100000, size: 1000 },
                    colorFunction,
                    labelFunction
                );
            });
        </script>
    </body>
</html>